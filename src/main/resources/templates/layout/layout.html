<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">


<head>
  <meta charset="UTF-8">
<!--  <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
  <title>eatMate</title>
  <link rel="stylesheet" th:href="@{/css/layout/layout.css}">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">
</head>

<body>
<!-- Header -->
<header>

  <div class="logo">
    <img th:src="@{/img/logo.png}" alt="eatMate Logo">
  </div>

  <nav class="user-tab jua-regular">
    <ul>
      <!--sec:authorize="isAuthenticated()"-->
      <!-- 로그인된 사용자일 경우 닉네임과 프로필 이미지 표시 -->
      <li sec:authorize="isAuthenticated()">
        <span class="nickname" th:text="${#authentication.principal.attributes['nickname']} + '님'"></span>
        <a th:href="@{/profile/list}">
          <img th:src="@{/img/profile.png}" alt="프로필">
        </a>
      </li>
      <!--sec:authorize="isAnonymous()"-->
      <li sec:authorize="isAnonymous()">
        <a th:href="@{/login}"><img th:src="@{/img/Login.png}" alt="로그인"></a></li>
      <!--sec:authorize="isAuthenticated()"-->
      <li sec:authorize="isAuthenticated()">
        <a id="logoutButton" href="javascript:void(0)"><img th:src="@{/img/Logout.png}" alt="로그아웃"></a>
      </li>
      <!--sec:authorize="isAnonymous()"-->
      <!--<li sec:authorize="isAnonymous()"><a th:href="@{/join}">회원가입</a></li>-->
    </ul>
  </nav>

  <nav class="main-action jua-regular">
    <ul>
      <li><a th:href="@{/}">Home</a></li>
      <li><a th:href="@{/post/list}">Find a Mate</a></li>
      <li><a th:href="@{/post/create}">Create a Mate</a></li>
    </ul>
  </nav>

</header>

<!-- Content Section -->
<div layout:fragment="content" class="jua-regular center">
  <!-- This is where page-specific content will be included -->
</div>

<!-- Footer -->
<footer>
  <div class="footer-logo">
    <img th:src="@{/img/logo.png}" alt="eatMate Logo">
  </div>
  <div class="footer-links">
    <a href="https://github.com/BonuKoo/eatMate" target="_blank" class="bi bi-github"></a>
  </div>
</footer>
</body>
<script>
  document.getElementById('logoutButton').addEventListener('click', function() {
      // 세션에서 provider 정보 가져오기
      fetch('/get-provider')
          .then(response => response.json())
          .then(data => {
              const provider = data.provider;
              if (provider === 'kakao') {
                  window.location.href = '/kakao/logout';
              } else if (provider === 'naver') {
                  window.location.href = '/naver/logout';
              } else if (provider === 'google') {
                  window.location.href = '/google/logout';
              } else if (provider === 'local') {
                  window.location.href = '/logout';  // 일반 로그아웃 처리
              } else {
                  console.error('Unknown provider');
              }
          })
          .catch(error => console.error('Error fetching provider:', error));
  });
</script>
</html>
